<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<!--[if IE]><meta http-equiv="X-UA-Compatible" content="IE=edge"><![endif]-->
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<meta name="generator" content="Asciidoctor 1.5.7.1">
<meta name="description" content="Nextflow implementation patterns.">
<meta name="keywords" content="Nextflow, computational workflows, patterns">
<title>Nextflow Patterns</title>
<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:300,300italic,400,400italic,600,600italic%7CNoto+Serif:400,400italic,700,700italic%7CDroid+Sans+Mono:400,700">
<style>
/* Asciidoctor default stylesheet | MIT License | http://asciidoctor.org */
/* Uncomment @import statement below to use as custom stylesheet */
/*@import "https://fonts.googleapis.com/css?family=Open+Sans:300,300italic,400,400italic,600,600italic%7CNoto+Serif:400,400italic,700,700italic%7CDroid+Sans+Mono:400,700";*/
article,aside,details,figcaption,figure,footer,header,hgroup,main,nav,section,summary{display:block}
audio,canvas,video{display:inline-block}
audio:not([controls]){display:none;height:0}
script{display:none!important}
html{font-family:sans-serif;-ms-text-size-adjust:100%;-webkit-text-size-adjust:100%}
a{background:transparent}
a:focus{outline:thin dotted}
a:active,a:hover{outline:0}
h1{font-size:2em;margin:.67em 0}
abbr[title]{border-bottom:1px dotted}
b,strong{font-weight:bold}
dfn{font-style:italic}
hr{-moz-box-sizing:content-box;box-sizing:content-box;height:0}
mark{background:#ff0;color:#000}
code,kbd,pre,samp{font-family:monospace;font-size:1em}
pre{white-space:pre-wrap}
q{quotes:"\201C" "\201D" "\2018" "\2019"}
small{font-size:80%}
sub,sup{font-size:75%;line-height:0;position:relative;vertical-align:baseline}
sup{top:-.5em}
sub{bottom:-.25em}
img{border:0}
svg:not(:root){overflow:hidden}
figure{margin:0}
fieldset{border:1px solid silver;margin:0 2px;padding:.35em .625em .75em}
legend{border:0;padding:0}
button,input,select,textarea{font-family:inherit;font-size:100%;margin:0}
button,input{line-height:normal}
button,select{text-transform:none}
button,html input[type="button"],input[type="reset"],input[type="submit"]{-webkit-appearance:button;cursor:pointer}
button[disabled],html input[disabled]{cursor:default}
input[type="checkbox"],input[type="radio"]{box-sizing:border-box;padding:0}
button::-moz-focus-inner,input::-moz-focus-inner{border:0;padding:0}
textarea{overflow:auto;vertical-align:top}
table{border-collapse:collapse;border-spacing:0}
*,*::before,*::after{-moz-box-sizing:border-box;-webkit-box-sizing:border-box;box-sizing:border-box}
html,body{font-size:100%}
body{background:#fff;color:rgba(0,0,0,.8);padding:0;margin:0;font-family:"Noto Serif","DejaVu Serif",serif;font-weight:400;font-style:normal;line-height:1;position:relative;cursor:auto;tab-size:4;-moz-osx-font-smoothing:grayscale;-webkit-font-smoothing:antialiased}
a:hover{cursor:pointer}
img,object,embed{max-width:100%;height:auto}
object,embed{height:100%}
img{-ms-interpolation-mode:bicubic}
.left{float:left!important}
.right{float:right!important}
.text-left{text-align:left!important}
.text-right{text-align:right!important}
.text-center{text-align:center!important}
.text-justify{text-align:justify!important}
.hide{display:none}
img,object,svg{display:inline-block;vertical-align:middle}
textarea{height:auto;min-height:50px}
select{width:100%}
.center{margin-left:auto;margin-right:auto}
.stretch{width:100%}
.subheader,.admonitionblock td.content>.title,.audioblock>.title,.exampleblock>.title,.imageblock>.title,.listingblock>.title,.literalblock>.title,.stemblock>.title,.openblock>.title,.paragraph>.title,.quoteblock>.title,table.tableblock>.title,.verseblock>.title,.videoblock>.title,.dlist>.title,.olist>.title,.ulist>.title,.qlist>.title,.hdlist>.title{line-height:1.45;color:#7a2518;font-weight:400;margin-top:0;margin-bottom:.25em}
div,dl,dt,dd,ul,ol,li,h1,h2,h3,#toctitle,.sidebarblock>.content>.title,h4,h5,h6,pre,form,p,blockquote,th,td{margin:0;padding:0;direction:ltr}
a{color:#2156a5;text-decoration:underline;line-height:inherit}
a:hover,a:focus{color:#1d4b8f}
a img{border:none}
p{font-family:inherit;font-weight:400;font-size:1em;line-height:1.6;margin-bottom:1.25em;text-rendering:optimizeLegibility}
p aside{font-size:.875em;line-height:1.35;font-style:italic}
h1,h2,h3,#toctitle,.sidebarblock>.content>.title,h4,h5,h6{font-family:"Open Sans","DejaVu Sans",sans-serif;font-weight:300;font-style:normal;color:#ba3925;text-rendering:optimizeLegibility;margin-top:1em;margin-bottom:.5em;line-height:1.0125em}
h1 small,h2 small,h3 small,#toctitle small,.sidebarblock>.content>.title small,h4 small,h5 small,h6 small{font-size:60%;color:#e99b8f;line-height:0}
h1{font-size:2.125em}
h2{font-size:1.6875em}
h3,#toctitle,.sidebarblock>.content>.title{font-size:1.375em}
h4,h5{font-size:1.125em}
h6{font-size:1em}
hr{border:solid #ddddd8;border-width:1px 0 0;clear:both;margin:1.25em 0 1.1875em;height:0}
em,i{font-style:italic;line-height:inherit}
strong,b{font-weight:bold;line-height:inherit}
small{font-size:60%;line-height:inherit}
code{font-family:"Droid Sans Mono","DejaVu Sans Mono",monospace;font-weight:400;color:rgba(0,0,0,.9)}
ul,ol,dl{font-size:1em;line-height:1.6;margin-bottom:1.25em;list-style-position:outside;font-family:inherit}
ul,ol{margin-left:1.5em}
ul li ul,ul li ol{margin-left:1.25em;margin-bottom:0;font-size:1em}
ul.square li ul,ul.circle li ul,ul.disc li ul{list-style:inherit}
ul.square{list-style-type:square}
ul.circle{list-style-type:circle}
ul.disc{list-style-type:disc}
ol li ul,ol li ol{margin-left:1.25em;margin-bottom:0}
dl dt{margin-bottom:.3125em;font-weight:bold}
dl dd{margin-bottom:1.25em}
abbr,acronym{text-transform:uppercase;font-size:90%;color:rgba(0,0,0,.8);border-bottom:1px dotted #ddd;cursor:help}
abbr{text-transform:none}
blockquote{margin:0 0 1.25em;padding:.5625em 1.25em 0 1.1875em;border-left:1px solid #ddd}
blockquote cite{display:block;font-size:.9375em;color:rgba(0,0,0,.6)}
blockquote cite::before{content:"\2014 \0020"}
blockquote cite a,blockquote cite a:visited{color:rgba(0,0,0,.6)}
blockquote,blockquote p{line-height:1.6;color:rgba(0,0,0,.85)}
@media screen and (min-width:768px){h1,h2,h3,#toctitle,.sidebarblock>.content>.title,h4,h5,h6{line-height:1.2}
h1{font-size:2.75em}
h2{font-size:2.3125em}
h3,#toctitle,.sidebarblock>.content>.title{font-size:1.6875em}
h4{font-size:1.4375em}}
table{background:#fff;margin-bottom:1.25em;border:solid 1px #dedede}
table thead,table tfoot{background:#f7f8f7}
table thead tr th,table thead tr td,table tfoot tr th,table tfoot tr td{padding:.5em .625em .625em;font-size:inherit;color:rgba(0,0,0,.8);text-align:left}
table tr th,table tr td{padding:.5625em .625em;font-size:inherit;color:rgba(0,0,0,.8)}
table tr.even,table tr.alt,table tr:nth-of-type(even){background:#f8f8f7}
table thead tr th,table tfoot tr th,table tbody tr td,table tr td,table tfoot tr td{display:table-cell;line-height:1.6}
h1,h2,h3,#toctitle,.sidebarblock>.content>.title,h4,h5,h6{line-height:1.2;word-spacing:-.05em}
h1 strong,h2 strong,h3 strong,#toctitle strong,.sidebarblock>.content>.title strong,h4 strong,h5 strong,h6 strong{font-weight:400}
.clearfix::before,.clearfix::after,.float-group::before,.float-group::after{content:" ";display:table}
.clearfix::after,.float-group::after{clear:both}
*:not(pre)>code{font-size:.9375em;font-style:normal!important;letter-spacing:0;padding:.1em .5ex;word-spacing:-.15em;background-color:#f7f7f8;-webkit-border-radius:4px;border-radius:4px;line-height:1.45;text-rendering:optimizeSpeed;word-wrap:break-word}
*:not(pre)>code.nobreak{word-wrap:normal}
*:not(pre)>code.nowrap{white-space:nowrap}
pre,pre>code{line-height:1.45;color:rgba(0,0,0,.9);font-family:"Droid Sans Mono","DejaVu Sans Mono",monospace;font-weight:400;text-rendering:optimizeSpeed}
em em{font-style:normal}
strong strong{font-weight:400}
.keyseq{color:rgba(51,51,51,.8)}
kbd{font-family:"Droid Sans Mono","DejaVu Sans Mono",monospace;display:inline-block;color:rgba(0,0,0,.8);font-size:.65em;line-height:1.45;background-color:#f7f7f7;border:1px solid #ccc;-webkit-border-radius:3px;border-radius:3px;-webkit-box-shadow:0 1px 0 rgba(0,0,0,.2),0 0 0 .1em white inset;box-shadow:0 1px 0 rgba(0,0,0,.2),0 0 0 .1em #fff inset;margin:0 .15em;padding:.2em .5em;vertical-align:middle;position:relative;top:-.1em;white-space:nowrap}
.keyseq kbd:first-child{margin-left:0}
.keyseq kbd:last-child{margin-right:0}
.menuseq,.menuref{color:#000}
.menuseq b:not(.caret),.menuref{font-weight:inherit}
.menuseq{word-spacing:-.02em}
.menuseq b.caret{font-size:1.25em;line-height:.8}
.menuseq i.caret{font-weight:bold;text-align:center;width:.45em}
b.button::before,b.button::after{position:relative;top:-1px;font-weight:400}
b.button::before{content:"[";padding:0 3px 0 2px}
b.button::after{content:"]";padding:0 2px 0 3px}
p a>code:hover{color:rgba(0,0,0,.9)}
#header,#content,#footnotes,#footer{width:100%;margin-left:auto;margin-right:auto;margin-top:0;margin-bottom:0;max-width:62.5em;*zoom:1;position:relative;padding-left:.9375em;padding-right:.9375em}
#header::before,#header::after,#content::before,#content::after,#footnotes::before,#footnotes::after,#footer::before,#footer::after{content:" ";display:table}
#header::after,#content::after,#footnotes::after,#footer::after{clear:both}
#content{margin-top:1.25em}
#content::before{content:none}
#header>h1:first-child{color:rgba(0,0,0,.85);margin-top:2.25rem;margin-bottom:0}
#header>h1:first-child+#toc{margin-top:8px;border-top:1px solid #ddddd8}
#header>h1:only-child,body.toc2 #header>h1:nth-last-child(2){border-bottom:1px solid #ddddd8;padding-bottom:8px}
#header .details{border-bottom:1px solid #ddddd8;line-height:1.45;padding-top:.25em;padding-bottom:.25em;padding-left:.25em;color:rgba(0,0,0,.6);display:-ms-flexbox;display:-webkit-flex;display:flex;-ms-flex-flow:row wrap;-webkit-flex-flow:row wrap;flex-flow:row wrap}
#header .details span:first-child{margin-left:-.125em}
#header .details span.email a{color:rgba(0,0,0,.85)}
#header .details br{display:none}
#header .details br+span::before{content:"\00a0\2013\00a0"}
#header .details br+span.author::before{content:"\00a0\22c5\00a0";color:rgba(0,0,0,.85)}
#header .details br+span#revremark::before{content:"\00a0|\00a0"}
#header #revnumber{text-transform:capitalize}
#header #revnumber::after{content:"\00a0"}
#content>h1:first-child:not([class]){color:rgba(0,0,0,.85);border-bottom:1px solid #ddddd8;padding-bottom:8px;margin-top:0;padding-top:1rem;margin-bottom:1.25rem}
#toc{border-bottom:1px solid #efefed;padding-bottom:.5em}
#toc>ul{margin-left:.125em}
#toc ul.sectlevel0>li>a{font-style:italic}
#toc ul.sectlevel0 ul.sectlevel1{margin:.5em 0}
#toc ul{font-family:"Open Sans","DejaVu Sans",sans-serif;list-style-type:none}
#toc li{line-height:1.3334;margin-top:.3334em}
#toc a{text-decoration:none}
#toc a:active{text-decoration:underline}
#toctitle{color:#7a2518;font-size:1.2em}
@media screen and (min-width:768px){#toctitle{font-size:1.375em}
body.toc2{padding-left:15em;padding-right:0}
#toc.toc2{margin-top:0!important;background-color:#f8f8f7;position:fixed;width:15em;left:0;top:0;border-right:1px solid #efefed;border-top-width:0!important;border-bottom-width:0!important;z-index:1000;padding:1.25em 1em;height:100%;overflow:auto}
#toc.toc2 #toctitle{margin-top:0;margin-bottom:.8rem;font-size:1.2em}
#toc.toc2>ul{font-size:.9em;margin-bottom:0}
#toc.toc2 ul ul{margin-left:0;padding-left:1em}
#toc.toc2 ul.sectlevel0 ul.sectlevel1{padding-left:0;margin-top:.5em;margin-bottom:.5em}
body.toc2.toc-right{padding-left:0;padding-right:15em}
body.toc2.toc-right #toc.toc2{border-right-width:0;border-left:1px solid #efefed;left:auto;right:0}}
@media screen and (min-width:1280px){body.toc2{padding-left:20em;padding-right:0}
#toc.toc2{width:20em}
#toc.toc2 #toctitle{font-size:1.375em}
#toc.toc2>ul{font-size:.95em}
#toc.toc2 ul ul{padding-left:1.25em}
body.toc2.toc-right{padding-left:0;padding-right:20em}}
#content #toc{border-style:solid;border-width:1px;border-color:#e0e0dc;margin-bottom:1.25em;padding:1.25em;background:#f8f8f7;-webkit-border-radius:4px;border-radius:4px}
#content #toc>:first-child{margin-top:0}
#content #toc>:last-child{margin-bottom:0}
#footer{max-width:100%;background-color:rgba(0,0,0,.8);padding:1.25em}
#footer-text{color:rgba(255,255,255,.8);line-height:1.44}
#content{margin-bottom:.625em}
.sect1{padding-bottom:.625em}
@media screen and (min-width:768px){#content{margin-bottom:1.25em}
.sect1{padding-bottom:1.25em}}
.sect1:last-child{padding-bottom:0}
.sect1+.sect1{border-top:1px solid #efefed}
#content h1>a.anchor,h2>a.anchor,h3>a.anchor,#toctitle>a.anchor,.sidebarblock>.content>.title>a.anchor,h4>a.anchor,h5>a.anchor,h6>a.anchor{position:absolute;z-index:1001;width:1.5ex;margin-left:-1.5ex;display:block;text-decoration:none!important;visibility:hidden;text-align:center;font-weight:400}
#content h1>a.anchor::before,h2>a.anchor::before,h3>a.anchor::before,#toctitle>a.anchor::before,.sidebarblock>.content>.title>a.anchor::before,h4>a.anchor::before,h5>a.anchor::before,h6>a.anchor::before{content:"\00A7";font-size:.85em;display:block;padding-top:.1em}
#content h1:hover>a.anchor,#content h1>a.anchor:hover,h2:hover>a.anchor,h2>a.anchor:hover,h3:hover>a.anchor,#toctitle:hover>a.anchor,.sidebarblock>.content>.title:hover>a.anchor,h3>a.anchor:hover,#toctitle>a.anchor:hover,.sidebarblock>.content>.title>a.anchor:hover,h4:hover>a.anchor,h4>a.anchor:hover,h5:hover>a.anchor,h5>a.anchor:hover,h6:hover>a.anchor,h6>a.anchor:hover{visibility:visible}
#content h1>a.link,h2>a.link,h3>a.link,#toctitle>a.link,.sidebarblock>.content>.title>a.link,h4>a.link,h5>a.link,h6>a.link{color:#ba3925;text-decoration:none}
#content h1>a.link:hover,h2>a.link:hover,h3>a.link:hover,#toctitle>a.link:hover,.sidebarblock>.content>.title>a.link:hover,h4>a.link:hover,h5>a.link:hover,h6>a.link:hover{color:#a53221}
.audioblock,.imageblock,.literalblock,.listingblock,.stemblock,.videoblock{margin-bottom:1.25em}
.admonitionblock td.content>.title,.audioblock>.title,.exampleblock>.title,.imageblock>.title,.listingblock>.title,.literalblock>.title,.stemblock>.title,.openblock>.title,.paragraph>.title,.quoteblock>.title,table.tableblock>.title,.verseblock>.title,.videoblock>.title,.dlist>.title,.olist>.title,.ulist>.title,.qlist>.title,.hdlist>.title{text-rendering:optimizeLegibility;text-align:left;font-family:"Noto Serif","DejaVu Serif",serif;font-size:1rem;font-style:italic}
table.tableblock.fit-content>caption.title{white-space:nowrap;width:0}
.paragraph.lead>p,#preamble>.sectionbody>[class="paragraph"]:first-of-type p{font-size:1.21875em;line-height:1.6;color:rgba(0,0,0,.85)}
table.tableblock #preamble>.sectionbody>[class="paragraph"]:first-of-type p{font-size:inherit}
.admonitionblock>table{border-collapse:separate;border:0;background:none;width:100%}
.admonitionblock>table td.icon{text-align:center;width:80px}
.admonitionblock>table td.icon img{max-width:none}
.admonitionblock>table td.icon .title{font-weight:bold;font-family:"Open Sans","DejaVu Sans",sans-serif;text-transform:uppercase}
.admonitionblock>table td.content{padding-left:1.125em;padding-right:1.25em;border-left:1px solid #ddddd8;color:rgba(0,0,0,.6)}
.admonitionblock>table td.content>:last-child>:last-child{margin-bottom:0}
.exampleblock>.content{border-style:solid;border-width:1px;border-color:#e6e6e6;margin-bottom:1.25em;padding:1.25em;background:#fff;-webkit-border-radius:4px;border-radius:4px}
.exampleblock>.content>:first-child{margin-top:0}
.exampleblock>.content>:last-child{margin-bottom:0}
.sidebarblock{border-style:solid;border-width:1px;border-color:#e0e0dc;margin-bottom:1.25em;padding:1.25em;background:#f8f8f7;-webkit-border-radius:4px;border-radius:4px}
.sidebarblock>:first-child{margin-top:0}
.sidebarblock>:last-child{margin-bottom:0}
.sidebarblock>.content>.title{color:#7a2518;margin-top:0;text-align:center}
.exampleblock>.content>:last-child>:last-child,.exampleblock>.content .olist>ol>li:last-child>:last-child,.exampleblock>.content .ulist>ul>li:last-child>:last-child,.exampleblock>.content .qlist>ol>li:last-child>:last-child,.sidebarblock>.content>:last-child>:last-child,.sidebarblock>.content .olist>ol>li:last-child>:last-child,.sidebarblock>.content .ulist>ul>li:last-child>:last-child,.sidebarblock>.content .qlist>ol>li:last-child>:last-child{margin-bottom:0}
.literalblock pre,.listingblock pre:not(.highlight),.listingblock pre[class="highlight"],.listingblock pre[class^="highlight "],.listingblock pre.CodeRay,.listingblock pre.prettyprint{background:#f7f7f8}
.sidebarblock .literalblock pre,.sidebarblock .listingblock pre:not(.highlight),.sidebarblock .listingblock pre[class="highlight"],.sidebarblock .listingblock pre[class^="highlight "],.sidebarblock .listingblock pre.CodeRay,.sidebarblock .listingblock pre.prettyprint{background:#f2f1f1}
.literalblock pre,.literalblock pre[class],.listingblock pre,.listingblock pre[class]{-webkit-border-radius:4px;border-radius:4px;word-wrap:break-word;padding:1em;font-size:.8125em}
.literalblock pre.nowrap,.literalblock pre[class].nowrap,.listingblock pre.nowrap,.listingblock pre[class].nowrap{overflow-x:auto;white-space:pre;word-wrap:normal}
@media screen and (min-width:768px){.literalblock pre,.literalblock pre[class],.listingblock pre,.listingblock pre[class]{font-size:.90625em}}
@media screen and (min-width:1280px){.literalblock pre,.literalblock pre[class],.listingblock pre,.listingblock pre[class]{font-size:1em}}
.literalblock.output pre{color:#f7f7f8;background-color:rgba(0,0,0,.9)}
.listingblock pre.highlightjs{padding:0}
.listingblock pre.highlightjs>code{padding:1em;-webkit-border-radius:4px;border-radius:4px}
.listingblock pre.prettyprint{border-width:0}
.listingblock>.content{position:relative}
.listingblock code[data-lang]::before{display:none;content:attr(data-lang);position:absolute;font-size:.75em;top:.425rem;right:.5rem;line-height:1;text-transform:uppercase;color:#999}
.listingblock:hover code[data-lang]::before{display:block}
.listingblock.terminal pre .command::before{content:attr(data-prompt);padding-right:.5em;color:#999}
.listingblock.terminal pre .command:not([data-prompt])::before{content:"$"}
table.pyhltable{border-collapse:separate;border:0;margin-bottom:0;background:none}
table.pyhltable td{vertical-align:top;padding-top:0;padding-bottom:0;line-height:1.45}
table.pyhltable td.code{padding-left:.75em;padding-right:0}
pre.pygments .lineno,table.pyhltable td:not(.code){color:#999;padding-left:0;padding-right:.5em;border-right:1px solid #ddddd8}
pre.pygments .lineno{display:inline-block;margin-right:.25em}
table.pyhltable .linenodiv{background:none!important;padding-right:0!important}
.quoteblock{margin:0 1em 1.25em 1.5em;display:table}
.quoteblock>.title{margin-left:-1.5em;margin-bottom:.75em}
.quoteblock blockquote,.quoteblock blockquote p{color:rgba(0,0,0,.85);font-size:1.15rem;line-height:1.75;word-spacing:.1em;letter-spacing:0;font-style:italic;text-align:justify}
.quoteblock blockquote{margin:0;padding:0;border:0}
.quoteblock blockquote::before{content:"\201c";float:left;font-size:2.75em;font-weight:bold;line-height:.6em;margin-left:-.6em;color:#7a2518;text-shadow:0 1px 2px rgba(0,0,0,.1)}
.quoteblock blockquote>.paragraph:last-child p{margin-bottom:0}
.quoteblock .attribution{margin-top:.5em;margin-right:.5ex;text-align:right}
.quoteblock .quoteblock{margin-left:0;margin-right:0;padding:.5em 0;border-left:3px solid rgba(0,0,0,.6)}
.quoteblock .quoteblock blockquote{padding:0 0 0 .75em}
.quoteblock .quoteblock blockquote::before{display:none}
.verseblock{margin:0 1em 1.25em}
.verseblock pre{font-family:"Open Sans","DejaVu Sans",sans;font-size:1.15rem;color:rgba(0,0,0,.85);font-weight:300;text-rendering:optimizeLegibility}
.verseblock pre strong{font-weight:400}
.verseblock .attribution{margin-top:1.25rem;margin-left:.5ex}
.quoteblock .attribution,.verseblock .attribution{font-size:.9375em;line-height:1.45;font-style:italic}
.quoteblock .attribution br,.verseblock .attribution br{display:none}
.quoteblock .attribution cite,.verseblock .attribution cite{display:block;letter-spacing:-.025em;color:rgba(0,0,0,.6)}
.quoteblock.abstract{margin:0 1em 1.25em;display:block}
.quoteblock.abstract>.title{margin:0 0 .375em;font-size:1.15em;text-align:center}
.quoteblock.abstract blockquote,.quoteblock.abstract blockquote p{word-spacing:0;line-height:1.6}
.quoteblock.abstract blockquote::before,.quoteblock.abstract p::before{display:none}
table.tableblock{max-width:100%;border-collapse:separate}
p.tableblock:last-child{margin-bottom:0}
td.tableblock>.content{margin-bottom:-1.25em}
table.tableblock,th.tableblock,td.tableblock{border:0 solid #dedede}
table.grid-all>thead>tr>.tableblock,table.grid-all>tbody>tr>.tableblock{border-width:0 1px 1px 0}
table.grid-all>tfoot>tr>.tableblock{border-width:1px 1px 0 0}
table.grid-cols>*>tr>.tableblock{border-width:0 1px 0 0}
table.grid-rows>thead>tr>.tableblock,table.grid-rows>tbody>tr>.tableblock{border-width:0 0 1px}
table.grid-rows>tfoot>tr>.tableblock{border-width:1px 0 0}
table.grid-all>*>tr>.tableblock:last-child,table.grid-cols>*>tr>.tableblock:last-child{border-right-width:0}
table.grid-all>tbody>tr:last-child>.tableblock,table.grid-all>thead:last-child>tr>.tableblock,table.grid-rows>tbody>tr:last-child>.tableblock,table.grid-rows>thead:last-child>tr>.tableblock{border-bottom-width:0}
table.frame-all{border-width:1px}
table.frame-sides{border-width:0 1px}
table.frame-topbot,table.frame-ends{border-width:1px 0}
table.stripes-all tr,table.stripes-odd tr:nth-of-type(odd){background:#f8f8f7}
table.stripes-none tr,table.stripes-odd tr:nth-of-type(even){background:none}
th.halign-left,td.halign-left{text-align:left}
th.halign-right,td.halign-right{text-align:right}
th.halign-center,td.halign-center{text-align:center}
th.valign-top,td.valign-top{vertical-align:top}
th.valign-bottom,td.valign-bottom{vertical-align:bottom}
th.valign-middle,td.valign-middle{vertical-align:middle}
table thead th,table tfoot th{font-weight:bold}
tbody tr th{display:table-cell;line-height:1.6;background:#f7f8f7}
tbody tr th,tbody tr th p,tfoot tr th,tfoot tr th p{color:rgba(0,0,0,.8);font-weight:bold}
p.tableblock>code:only-child{background:none;padding:0}
p.tableblock{font-size:1em}
td>div.verse{white-space:pre}
ol{margin-left:1.75em}
ul li ol{margin-left:1.5em}
dl dd{margin-left:1.125em}
dl dd:last-child,dl dd:last-child>:last-child{margin-bottom:0}
ol>li p,ul>li p,ul dd,ol dd,.olist .olist,.ulist .ulist,.ulist .olist,.olist .ulist{margin-bottom:.625em}
ul.checklist,ul.none,ol.none,ul.no-bullet,ol.no-bullet,ol.unnumbered,ul.unstyled,ol.unstyled{list-style-type:none}
ul.no-bullet,ol.no-bullet,ol.unnumbered{margin-left:.625em}
ul.unstyled,ol.unstyled{margin-left:0}
ul.checklist{margin-left:.625em}
ul.checklist li>p:first-child>.fa-square-o:first-child,ul.checklist li>p:first-child>.fa-check-square-o:first-child{width:1.25em;font-size:.8em;position:relative;bottom:.125em}
ul.checklist li>p:first-child>input[type="checkbox"]:first-child{margin-right:.25em}
ul.inline{display:-ms-flexbox;display:-webkit-box;display:flex;-ms-flex-flow:row wrap;-webkit-flex-flow:row wrap;flex-flow:row wrap;list-style:none;margin:0 0 .625em -1.25em}
ul.inline>li{margin-left:1.25em}
.unstyled dl dt{font-weight:400;font-style:normal}
ol.arabic{list-style-type:decimal}
ol.decimal{list-style-type:decimal-leading-zero}
ol.loweralpha{list-style-type:lower-alpha}
ol.upperalpha{list-style-type:upper-alpha}
ol.lowerroman{list-style-type:lower-roman}
ol.upperroman{list-style-type:upper-roman}
ol.lowergreek{list-style-type:lower-greek}
.hdlist>table,.colist>table{border:0;background:none}
.hdlist>table>tbody>tr,.colist>table>tbody>tr{background:none}
td.hdlist1,td.hdlist2{vertical-align:top;padding:0 .625em}
td.hdlist1{font-weight:bold;padding-bottom:1.25em}
.literalblock+.colist,.listingblock+.colist{margin-top:-.5em}
.colist td:not([class]):first-child{padding:.4em .75em 0;line-height:1;vertical-align:top}
.colist td:not([class]):first-child img{max-width:none}
.colist td:not([class]):last-child{padding:.25em 0}
.thumb,.th{line-height:0;display:inline-block;border:solid 4px #fff;-webkit-box-shadow:0 0 0 1px #ddd;box-shadow:0 0 0 1px #ddd}
.imageblock.left,.imageblock[style*="float: left"]{margin:.25em .625em 1.25em 0}
.imageblock.right,.imageblock[style*="float: right"]{margin:.25em 0 1.25em .625em}
.imageblock>.title{margin-bottom:0}
.imageblock.thumb,.imageblock.th{border-width:6px}
.imageblock.thumb>.title,.imageblock.th>.title{padding:0 .125em}
.image.left,.image.right{margin-top:.25em;margin-bottom:.25em;display:inline-block;line-height:0}
.image.left{margin-right:.625em}
.image.right{margin-left:.625em}
a.image{text-decoration:none;display:inline-block}
a.image object{pointer-events:none}
sup.footnote,sup.footnoteref{font-size:.875em;position:static;vertical-align:super}
sup.footnote a,sup.footnoteref a{text-decoration:none}
sup.footnote a:active,sup.footnoteref a:active{text-decoration:underline}
#footnotes{padding-top:.75em;padding-bottom:.75em;margin-bottom:.625em}
#footnotes hr{width:20%;min-width:6.25em;margin:-.25em 0 .75em;border-width:1px 0 0}
#footnotes .footnote{padding:0 .375em 0 .225em;line-height:1.3334;font-size:.875em;margin-left:1.2em;margin-bottom:.2em}
#footnotes .footnote a:first-of-type{font-weight:bold;text-decoration:none;margin-left:-1.05em}
#footnotes .footnote:last-of-type{margin-bottom:0}
#content #footnotes{margin-top:-.625em;margin-bottom:0;padding:.75em 0}
.gist .file-data>table{border:0;background:#fff;width:100%;margin-bottom:0}
.gist .file-data>table td.line-data{width:99%}
div.unbreakable{page-break-inside:avoid}
.big{font-size:larger}
.small{font-size:smaller}
.underline{text-decoration:underline}
.overline{text-decoration:overline}
.line-through{text-decoration:line-through}
.aqua{color:#00bfbf}
.aqua-background{background-color:#00fafa}
.black{color:#000}
.black-background{background-color:#000}
.blue{color:#0000bf}
.blue-background{background-color:#0000fa}
.fuchsia{color:#bf00bf}
.fuchsia-background{background-color:#fa00fa}
.gray{color:#606060}
.gray-background{background-color:#7d7d7d}
.green{color:#006000}
.green-background{background-color:#007d00}
.lime{color:#00bf00}
.lime-background{background-color:#00fa00}
.maroon{color:#600000}
.maroon-background{background-color:#7d0000}
.navy{color:#000060}
.navy-background{background-color:#00007d}
.olive{color:#606000}
.olive-background{background-color:#7d7d00}
.purple{color:#600060}
.purple-background{background-color:#7d007d}
.red{color:#bf0000}
.red-background{background-color:#fa0000}
.silver{color:#909090}
.silver-background{background-color:#bcbcbc}
.teal{color:#006060}
.teal-background{background-color:#007d7d}
.white{color:#bfbfbf}
.white-background{background-color:#fafafa}
.yellow{color:#bfbf00}
.yellow-background{background-color:#fafa00}
span.icon>.fa{cursor:default}
a span.icon>.fa{cursor:inherit}
.admonitionblock td.icon [class^="fa icon-"]{font-size:2.5em;text-shadow:1px 1px 2px rgba(0,0,0,.5);cursor:default}
.admonitionblock td.icon .icon-note::before{content:"\f05a";color:#19407c}
.admonitionblock td.icon .icon-tip::before{content:"\f0eb";text-shadow:1px 1px 2px rgba(155,155,0,.8);color:#111}
.admonitionblock td.icon .icon-warning::before{content:"\f071";color:#bf6900}
.admonitionblock td.icon .icon-caution::before{content:"\f06d";color:#bf3400}
.admonitionblock td.icon .icon-important::before{content:"\f06a";color:#bf0000}
.conum[data-value]{display:inline-block;color:#fff!important;background-color:rgba(0,0,0,.8);-webkit-border-radius:100px;border-radius:100px;text-align:center;font-size:.75em;width:1.67em;height:1.67em;line-height:1.67em;font-family:"Open Sans","DejaVu Sans",sans-serif;font-style:normal;font-weight:bold}
.conum[data-value] *{color:#fff!important}
.conum[data-value]+b{display:none}
.conum[data-value]::after{content:attr(data-value)}
pre .conum[data-value]{position:relative;top:-.125em}
b.conum *{color:inherit!important}
.conum:not([data-value]):empty{display:none}
dt,th.tableblock,td.content,div.footnote{text-rendering:optimizeLegibility}
h1,h2,p,td.content,span.alt{letter-spacing:-.01em}
p strong,td.content strong,div.footnote strong{letter-spacing:-.005em}
p,blockquote,dt,td.content,span.alt{font-size:1.0625rem}
p{margin-bottom:1.25rem}
.sidebarblock p,.sidebarblock dt,.sidebarblock td.content,p.tableblock{font-size:1em}
.exampleblock>.content{background-color:#fffef7;border-color:#e0e0dc;-webkit-box-shadow:0 1px 4px #e0e0dc;box-shadow:0 1px 4px #e0e0dc}
.print-only{display:none!important}
@page{margin:1.25cm .75cm}
@media print{*{-webkit-box-shadow:none!important;box-shadow:none!important;text-shadow:none!important}
html{font-size:80%}
a{color:inherit!important;text-decoration:underline!important}
a.bare,a[href^="#"],a[href^="mailto:"]{text-decoration:none!important}
a[href^="http:"]:not(.bare)::after,a[href^="https:"]:not(.bare)::after{content:"(" attr(href) ")";display:inline-block;font-size:.875em;padding-left:.25em}
abbr[title]::after{content:" (" attr(title) ")"}
pre,blockquote,tr,img,object,svg{page-break-inside:avoid}
thead{display:table-header-group}
svg{max-width:100%}
p,blockquote,dt,td.content{font-size:1em;orphans:3;widows:3}
h2,h3,#toctitle,.sidebarblock>.content>.title{page-break-after:avoid}
#toc,.sidebarblock,.exampleblock>.content{background:none!important}
#toc{border-bottom:1px solid #ddddd8!important;padding-bottom:0!important}
body.book #header{text-align:center}
body.book #header>h1:first-child{border:0!important;margin:2.5em 0 1em}
body.book #header .details{border:0!important;display:block;padding:0!important}
body.book #header .details span:first-child{margin-left:0!important}
body.book #header .details br{display:block}
body.book #header .details br+span::before{content:none!important}
body.book #toc{border:0!important;text-align:left!important;padding:0!important;margin:0!important}
body.book #toc,body.book #preamble,body.book h1.sect0,body.book .sect1>h2{page-break-before:always}
.listingblock code[data-lang]::before{display:block}
#footer{padding:0 .9375em}
.hide-on-print{display:none!important}
.print-only{display:block!important}
.hide-for-print{display:none!important}
.show-for-print{display:inherit!important}}
@media print,amzn-kf8{#header>h1:first-child{margin-top:1.25rem}
.sect1{padding:0!important}
.sect1+.sect1{border:0}
#footer{background:none}
#footer-text{color:rgba(0,0,0,.6);font-size:.9em}}
@media amzn-kf8{#header,#content,#footnotes,#footer{padding:0}}
</style>
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css">
<style>
/* Stylesheet for CodeRay to match GitHub theme | MIT License | http://foundation.zurb.com */
/*pre.CodeRay {background-color:#f7f7f8;}*/
.CodeRay .line-numbers{border-right:1px solid #d8d8d8;padding:0 0.5em 0 .25em}
.CodeRay span.line-numbers{display:inline-block;margin-right:.5em;color:rgba(0,0,0,.3)}
.CodeRay .line-numbers strong{color:rgba(0,0,0,.4)}
table.CodeRay{border-collapse:separate;border-spacing:0;margin-bottom:0;border:0;background:none}
table.CodeRay td{vertical-align: top;line-height:1.45}
table.CodeRay td.line-numbers{text-align:right}
table.CodeRay td.line-numbers>pre{padding:0;color:rgba(0,0,0,.3)}
table.CodeRay td.code{padding:0 0 0 .5em}
table.CodeRay td.code>pre{padding:0}
.CodeRay .debug{color:#fff !important;background:#000080 !important}
.CodeRay .annotation{color:#007}
.CodeRay .attribute-name{color:#000080}
.CodeRay .attribute-value{color:#700}
.CodeRay .binary{color:#509}
.CodeRay .comment{color:#998;font-style:italic}
.CodeRay .char{color:#04d}
.CodeRay .char .content{color:#04d}
.CodeRay .char .delimiter{color:#039}
.CodeRay .class{color:#458;font-weight:bold}
.CodeRay .complex{color:#a08}
.CodeRay .constant,.CodeRay .predefined-constant{color:#008080}
.CodeRay .color{color:#099}
.CodeRay .class-variable{color:#369}
.CodeRay .decorator{color:#b0b}
.CodeRay .definition{color:#099}
.CodeRay .delimiter{color:#000}
.CodeRay .doc{color:#970}
.CodeRay .doctype{color:#34b}
.CodeRay .doc-string{color:#d42}
.CodeRay .escape{color:#666}
.CodeRay .entity{color:#800}
.CodeRay .error{color:#808}
.CodeRay .exception{color:inherit}
.CodeRay .filename{color:#099}
.CodeRay .function{color:#900;font-weight:bold}
.CodeRay .global-variable{color:#008080}
.CodeRay .hex{color:#058}
.CodeRay .integer,.CodeRay .float{color:#099}
.CodeRay .include{color:#555}
.CodeRay .inline{color:#000}
.CodeRay .inline .inline{background:#ccc}
.CodeRay .inline .inline .inline{background:#bbb}
.CodeRay .inline .inline-delimiter{color:#d14}
.CodeRay .inline-delimiter{color:#d14}
.CodeRay .important{color:#555;font-weight:bold}
.CodeRay .interpreted{color:#b2b}
.CodeRay .instance-variable{color:#008080}
.CodeRay .label{color:#970}
.CodeRay .local-variable{color:#963}
.CodeRay .octal{color:#40e}
.CodeRay .predefined{color:#369}
.CodeRay .preprocessor{color:#579}
.CodeRay .pseudo-class{color:#555}
.CodeRay .directive{font-weight:bold}
.CodeRay .type{font-weight:bold}
.CodeRay .predefined-type{color:inherit}
.CodeRay .reserved,.CodeRay .keyword {color:#000;font-weight:bold}
.CodeRay .key{color:#808}
.CodeRay .key .delimiter{color:#606}
.CodeRay .key .char{color:#80f}
.CodeRay .value{color:#088}
.CodeRay .regexp .delimiter{color:#808}
.CodeRay .regexp .content{color:#808}
.CodeRay .regexp .modifier{color:#808}
.CodeRay .regexp .char{color:#d14}
.CodeRay .regexp .function{color:#404;font-weight:bold}
.CodeRay .string{color:#d20}
.CodeRay .string .string .string{background:#ffd0d0}
.CodeRay .string .content{color:#d14}
.CodeRay .string .char{color:#d14}
.CodeRay .string .delimiter{color:#d14}
.CodeRay .shell{color:#d14}
.CodeRay .shell .delimiter{color:#d14}
.CodeRay .symbol{color:#990073}
.CodeRay .symbol .content{color:#a60}
.CodeRay .symbol .delimiter{color:#630}
.CodeRay .tag{color:#008080}
.CodeRay .tag-special{color:#d70}
.CodeRay .variable{color:#036}
.CodeRay .insert{background:#afa}
.CodeRay .delete{background:#faa}
.CodeRay .change{color:#aaf;background:#007}
.CodeRay .head{color:#f8f;background:#505}
.CodeRay .insert .insert{color:#080}
.CodeRay .delete .delete{color:#800}
.CodeRay .change .change{color:#66f}
.CodeRay .head .head{color:#f4f}
</style>
<!-- fixes nowrap line numbers https://github.com/asciidoctor/asciidoctor/issues/1706#issuecomment-314601209 -->
<style>
table.CodeRay { display: block; overflow-x: auto; }
td.code > pre { white-space: pre; }
</style>
</head>
<body class="article toc2 toc-left">
<div id="header">
<h1>Nextflow Patterns <span class="image Nextflow Logo" style="float: right"><img src="https://www.nextflow.io/img/nextflow2014_no-bg.png" alt="Logo" width="300" height="100"></span></h1>
<div id="toc" class="toc2">
<div id="toctitle">Table of Contents</div>
<ul class="sectlevel1">
<li><a href="#_basic_patterns">1. Basic patterns</a>
<ul class="sectlevel2">
<li><a href="#_channel_duplication">1.1. Channel duplication</a></li>
</ul>
</li>
<li><a href="#_scatter_executions">2. Scatter executions</a>
<ul class="sectlevel2">
<li><a href="#_process_per_file_path">2.1. Process per file path</a></li>
<li><a href="#_process_per_file_chunk">2.2. Process per file chunk</a></li>
<li><a href="#_process_per_file_pairs">2.3. Process per file pairs</a></li>
<li><a href="#_process_per_file_range">2.4. Process per file range</a></li>
<li><a href="#_process_per_csv_record">2.5. Process per CSV record</a></li>
<li><a href="#_process_per_file_output">2.6. Process per file output</a></li>
</ul>
</li>
<li><a href="#_gather_results">3. Gather results</a>
<ul class="sectlevel2">
<li><a href="#_process_all_outputs_altogether">3.1. Process all outputs altogether</a></li>
<li><a href="#_process_outputs_into_groups">3.2. Process outputs into groups</a></li>
<li><a href="#_collect_outputs_into_a_file">3.3. Collect outputs into a file</a></li>
</ul>
</li>
<li><a href="#_organize_outputs">4. Organize outputs</a>
<ul class="sectlevel2">
<li><a href="#_store_process_outputs">4.1. Store process outputs</a></li>
<li><a href="#_store_outputs_matching_a_glob_pattern">4.2. Store outputs matching a glob pattern</a></li>
<li><a href="#_rename_process_outputs">4.3. Rename process outputs</a></li>
</ul>
</li>
<li><a href="#_other">5. Other</a>
<ul class="sectlevel2">
<li><a href="#_get_process_work_directory">5.1. Get process work directory</a></li>
<li><a href="#_ignore_failing_process">5.2. Ignore failing process</a></li>
<li><a href="#_mock_dependency">5.3. Mock dependency</a></li>
</ul>
</li>
<li><a href="#_advanced_patterns">6. Advanced patterns</a>
<ul class="sectlevel2">
<li><a href="#_conditional_resources_definition">6.1. Conditional resources definition</a></li>
<li><a href="#_conditional_process_executions">6.2. Conditional process executions</a></li>
<li><a href="#_skip_process_execution">6.3. Skip process execution</a></li>
<li><a href="#_feedback_loop">6.4. Feedback loop</a></li>
<li><a href="#_optional_input">6.5. Optional input</a></li>
<li><a href="#_optional_output">6.6. Optional output</a></li>
<li><a href="#_execute_when_empty">6.7. Execute when empty</a></li>
</ul>
</li>
</ul>
</div>
</div>
<div id="content">
<div id="preamble">
<div class="sectionbody">
<div class="paragraph">
<p>This page collects some recurrent implementation patterns used in Nextflow applications.
Feel free to contribute opening a pull request in the GitHub repository at <a href="https://github.com/nextflow-io/patterns">this link</a>.</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_basic_patterns"><a class="link" href="#_basic_patterns">1. Basic patterns</a></h2>
<div class="sectionbody">
<div class="sect2">
<h3 id="_channel_duplication"><a class="link" href="#_channel_duplication">1.1. Channel duplication</a></h3>
<div class="sect3">
<h4 id="_problem"><a class="link" href="#_problem">1.1.1. Problem</a></h4>
<div class="paragraph">
<p>You need to you use the same channel as input in two or more processes.</p>
</div>
</div>
<div class="sect3">
<h4 id="_solution"><a class="link" href="#_solution">1.1.2. Solution</a></h4>
<div class="paragraph">
<p>Use the <a href="https://www.nextflow.io/docs/latest/operator.html#into">into</a> operator to create two (or more) copies of the source channel. Then, use the new channels as input for the processes.</p>
</div>
</div>
<div class="sect3">
<h4 id="_code"><a class="link" href="#_code">1.1.3. Code</a></h4>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight nowrap"><code data-lang="nextflow"><table class="CodeRay"><tr>
  <td class="line-numbers"><pre>1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
</pre></td>
  <td class="code"><pre>Channel
    .fromPath('prots/*_?.fa')
    .into { prot1_ch; prot2_ch }

process foo {
  input: file x from prot1_ch
  script:
  &quot;&quot;&quot;
    echo your_command --input $x
  &quot;&quot;&quot;
}

process bar {
  input: file x from prot2_ch
  script:
  &quot;&quot;&quot;
    your_command --input $x
  &quot;&quot;&quot;
}</pre></td>
</tr></table></code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_run_it"><a class="link" href="#_run_it">1.1.4. Run it</a></h4>
<div class="paragraph">
<p>Use the the following command to execute the example:</p>
</div>
<div class="literalblock">
<div class="content">
<pre>nextflow run patterns/channel-duplication.nf</pre>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_scatter_executions"><a class="link" href="#_scatter_executions">2. Scatter executions</a></h2>
<div class="sectionbody">
<div class="sect2">
<h3 id="_process_per_file_path"><a class="link" href="#_process_per_file_path">2.1. Process per file path</a></h3>
<div class="sect3">
<h4 id="_problem_2"><a class="link" href="#_problem_2">2.1.1. Problem</a></h4>
<div class="paragraph">
<p>You need to execute a task for each file that matches a glob pattern.</p>
</div>
</div>
<div class="sect3">
<h4 id="_solution_2"><a class="link" href="#_solution_2">2.1.2. Solution</a></h4>
<div class="paragraph">
<p>Use the <a href="https://www.nextflow.io/docs/latest/channel.html#frompath">Channel.fromPath</a> method to create a channel emitting all files matching the glob pattern. Then, use the channel as input of the process implementing your task.</p>
</div>
</div>
<div class="sect3">
<h4 id="_code_2"><a class="link" href="#_code_2">2.1.3. Code</a></h4>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight nowrap"><code data-lang="nextflow"><table class="CodeRay"><tr>
  <td class="line-numbers"><pre>1
2
3
4
5
6
7
8
9
10
11
</pre></td>
  <td class="code"><pre>Channel.fromPath('reads/*_1.fq.gz').set{ samples_ch }

process foo {
  input:
  file x from samples_ch

  script:
  &quot;&quot;&quot;
  your_command --input $x
  &quot;&quot;&quot;
}</pre></td>
</tr></table></code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_run_it_2"><a class="link" href="#_run_it_2">2.1.4. Run it</a></h4>
<div class="paragraph">
<p>Use the the following command to execute the example:</p>
</div>
<div class="literalblock">
<div class="content">
<pre>nextflow run patterns/process-per-file-path.nf</pre>
</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_process_per_file_chunk"><a class="link" href="#_process_per_file_chunk">2.2. Process per file chunk</a></h3>
<div class="sect3">
<h4 id="_problem_3"><a class="link" href="#_problem_3">2.2.1. Problem</a></h4>
<div class="paragraph">
<p>You need to split one or more input files into chunks and execute a task for each of them.</p>
</div>
</div>
<div class="sect3">
<h4 id="_solution_3"><a class="link" href="#_solution_3">2.2.2. Solution</a></h4>
<div class="paragraph">
<p>Use the the <a href="https://www.nextflow.io/docs/latest/operator.html#splittext">splitText</a> operator to split a file in chunks of a given size. Then use the resulting channel as input for the process implementing your task.</p>
</div>
<div class="paragraph">
<p>Caveat: By default chunks are kept in memory. When splitting big files specify the parameter <code>file: true</code> to save the chunks into files. See the <a href="https://www.nextflow.io/docs/latest/operator.html#splittext">documentation</a> for details.</p>
</div>
<div class="paragraph">
<p>Splitter for specific file formats are available, eg <a href="https://www.nextflow.io/docs/latest/operator.html#splitfasta">splitFasta</a> and <a href="https://www.nextflow.io/docs/latest/operator.html#splitfastq">splitFastq</a>.</p>
</div>
</div>
<div class="sect3">
<h4 id="_code_3"><a class="link" href="#_code_3">2.2.3. Code</a></h4>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight nowrap"><code data-lang="nextflow"><table class="CodeRay"><tr>
  <td class="line-numbers"><pre>1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
</pre></td>
  <td class="code"><pre>Channel
    .fromPath('poem.txt')
    .splitText(by: 5)
    .set{ chunks_ch }

process foo {
  echo true
  input:
  file x from chunks_ch

  script:
  &quot;&quot;&quot;
  rev $x | rev
  &quot;&quot;&quot;
}</pre></td>
</tr></table></code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_run_it_3"><a class="link" href="#_run_it_3">2.2.4. Run it</a></h4>
<div class="paragraph">
<p>Use the the following command to execute the example:</p>
</div>
<div class="literalblock">
<div class="content">
<pre>nextflow run patterns/process-per-file-chunk.nf</pre>
</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_process_per_file_pairs"><a class="link" href="#_process_per_file_pairs">2.3. Process per file pairs</a></h3>
<div class="sect3">
<h4 id="_problem_4"><a class="link" href="#_problem_4">2.3.1. Problem</a></h4>
<div class="paragraph">
<p>You need to process the files into a directory grouping them by pairs.</p>
</div>
</div>
<div class="sect3">
<h4 id="_solution_4"><a class="link" href="#_solution_4">2.3.2. Solution</a></h4>
<div class="paragraph">
<p>Use the <a href="https://www.nextflow.io/docs/latest/channel.html#fromfilepairs">Channel.fromFilePairs</a> method to create a channel emitting the file pairs matching a glob pattern. The pattern must match a common prefix in the paired file names.</p>
</div>
<div class="paragraph">
<p>The matching files are emitted as tuples in which the first element is the grouping key of the matching files and the second element is the file pair itself.</p>
</div>
</div>
<div class="sect3">
<h4 id="_code_4"><a class="link" href="#_code_4">2.3.3. Code</a></h4>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight nowrap"><code data-lang="nextflow"><table class="CodeRay"><tr>
  <td class="line-numbers"><pre>1
2
3
4
5
6
7
8
9
10
11
12
13
</pre></td>
  <td class="code"><pre>Channel
    .fromFilePairs('reads/*_{1,2}.fq.gz')
    .set { samples_ch }

process foo {
  input:
  set sampleId, file(reads) from samples_ch

  script:
  &quot;&quot;&quot;
  your_command --sample $sampleId --reads $reads
  &quot;&quot;&quot;
}</pre></td>
</tr></table></code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_run_it_4"><a class="link" href="#_run_it_4">2.3.4. Run it</a></h4>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code>nextflow run patterns/process-per-file-pairs.nf</code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_custom_grouping_strategy"><a class="link" href="#_custom_grouping_strategy">2.3.5. Custom grouping strategy</a></h4>
<div class="paragraph">
<p>When needed it is possible to define a custom grouping strategy. A common use case is for alignment BAM files (<code>sample1.bam</code>) that come along with their index file. The difficulty is that the index is sometimes called <code>sample1.bai</code> and sometimes <code>sample1.bam.bai</code> depending on the software used. The following example can accommodate both cases.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight nowrap"><code data-lang="nextflow"><table class="CodeRay"><tr>
  <td class="line-numbers"><pre>1
2
3
4
5
6
7
8
9
10
11
12
13
</pre></td>
  <td class="code"><pre>Channel
    .fromFilePairs('alignment/*.{bam,bai}') { file -&gt; file.name.replaceAll(/.bam|.bai$/,'') }
    .set { samples_ch }

process foo {
  input:
  set sampleId, file(bam) from samples_ch

  script:
  &quot;&quot;&quot;
  your_command --sample $sampleId --bam ${sampleId}.bam
  &quot;&quot;&quot;
}</pre></td>
</tr></table></code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_run_it_5"><a class="link" href="#_run_it_5">2.3.6. Run it</a></h4>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code>nextflow run patterns/process-per-file-pairs-custom.nf</code></pre>
</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_process_per_file_range"><a class="link" href="#_process_per_file_range">2.4. Process per file range</a></h3>
<div class="sect3">
<h4 id="_problem_5"><a class="link" href="#_problem_5">2.4.1. Problem</a></h4>
<div class="paragraph">
<p>You need to execute a task over two or more series of files having a common index range.</p>
</div>
</div>
<div class="sect3">
<h4 id="_solution_5"><a class="link" href="#_solution_5">2.4.2. Solution</a></h4>
<div class="paragraph">
<p>Use a the <a href="https://www.nextflow.io/docs/latest/channel.html#from">from</a> method
define the range over which repeat the task execution,
then chain it with a <a href="https://www.nextflow.io/docs/latest/operator.html#map">map</a> operator
to associate the each index the corresponding input files. Finally use the resulting channel as input for the process.</p>
</div>
</div>
<div class="sect3">
<h4 id="_code_5"><a class="link" href="#_code_5">2.4.3. Code</a></h4>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight nowrap"><code data-lang="nextflow"><table class="CodeRay"><tr>
  <td class="line-numbers"><pre>1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
</pre></td>
  <td class="code"><pre>Channel
  .from(1..23)
  .map { chr -&gt; tuple(&quot;sample$chr&quot;, file(&quot;/some/path/foo.${chr}.indels.vcf&quot;), file(&quot;/other/path/foo.snvs.${chr}.vcf&quot;)) }
  .set { pairs_ch }


process foo {
  tag &quot;$sampleId&quot;

  input:
  set sampleId, file(indels), file(snps) from pairs_ch

  &quot;&quot;&quot;
  echo foo_command --this $indels --that $snps
  &quot;&quot;&quot;
}</pre></td>
</tr></table></code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_run_it_6"><a class="link" href="#_run_it_6">2.4.4. Run it</a></h4>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code>nextflow run patterns/process-per-file-range.nf</code></pre>
</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_process_per_csv_record"><a class="link" href="#_process_per_csv_record">2.5. Process per CSV record</a></h3>
<div class="sect3">
<h4 id="_problem_6"><a class="link" href="#_problem_6">2.5.1. Problem</a></h4>
<div class="paragraph">
<p>You need to execute a task for each record in one or more CSV files.</p>
</div>
</div>
<div class="sect3">
<h4 id="_solution_6"><a class="link" href="#_solution_6">2.5.2. Solution</a></h4>
<div class="paragraph">
<p>Read the CSV file line-by-line using the <a href="https://www.nextflow.io/docs/latest/operator.html#splitcsv">sliptCsv</a> operator, then use the <a href="https://www.nextflow.io/docs/latest/operator.html#map">map</a> to return a tuple with the required field for each line and convert any string path to a file path object using the <code>file</code> function.
Finally use the resulting channel as input for the process.</p>
</div>
</div>
<div class="sect3">
<h4 id="_code_6"><a class="link" href="#_code_6">2.5.3. Code</a></h4>
<div class="paragraph">
<p>Given the file <code>index.csv</code> with the following content:</p>
</div>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 33.3333%;">
<col style="width: 33.3333%;">
<col style="width: 33.3334%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">sampleId</th>
<th class="tableblock halign-left valign-top">read1</th>
<th class="tableblock halign-left valign-top">read2</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">FC816RLABXX</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">reads/110101_I315_FC816RLABXX_L1_HUMrutRGXDIAAPE_1.fq.gz</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">reads/110101_I315_FC816RLABXX_L1_HUMrutRGXDIAAPE_2.fq.gz</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">FC812MWABXX</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">reads/110105_I186_FC812MWABXX_L8_HUMrutRGVDIABPE_1.fq.gz</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">reads/110105_I186_FC812MWABXX_L8_HUMrutRGVDIABPE_2.fq.gz</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">FC81DE8ABXX</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">reads/110121_I288_FC81DE8ABXX_L3_HUMrutRGXDIAAPE_1.fq.gz</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">reads/110121_I288_FC81DE8ABXX_L3_HUMrutRGXDIAAPE_2.fq.gz</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">FC81DB5ABXX</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">reads/110122_I329_FC81DB5ABXX_L6_HUMrutRGVDIAAPE_1.fq.gz</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">reads/110122_I329_FC81DB5ABXX_L6_HUMrutRGVDIAAPE_2.fq.gz</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">FC819P0ABXX</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">reads/110128_I481_FC819P0ABXX_L5_HUMrutRGWDIAAPE_1.fq.gz</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">reads/110128_I481_FC819P0ABXX_L5_HUMrutRGWDIAAPE_2.fq.gz</p></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<p>This snippet parses the file and executes a process for each line:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight nowrap"><code data-lang="nextflow"><table class="CodeRay"><tr>
  <td class="line-numbers"><pre>1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
</pre></td>
  <td class="code"><pre>params.index = 'index.csv'

Channel
    .fromPath(params.index)
    .splitCsv(header:true)
    .map{ row-&gt; tuple(row.sampleId, file(row.read1), file(row.read2)) }
    .set { samples_ch }

process foo {
    input:
    set sampleId, file(read1), file(read2) from samples_ch

    script:
    &quot;&quot;&quot;
    echo your_command --sample $sampleId --reads $read1 $read2
    &quot;&quot;&quot;
}</pre></td>
</tr></table></code></pre>
</div>
</div>
<div class="paragraph">
<p>Note: relative paths are resolved by the <code>file</code> function against the execution directory.
In a real use case prefer absolute file paths.</p>
</div>
</div>
<div class="sect3">
<h4 id="_run_it_7"><a class="link" href="#_run_it_7">2.5.4. Run it</a></h4>
<div class="paragraph">
<p>Use the the following command to execute the example:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code>nextflow run patterns/process-per-csv-record.nf</code></pre>
</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_process_per_file_output"><a class="link" href="#_process_per_file_output">2.6. Process per file output</a></h3>
<div class="sect3">
<h4 id="_problem_7"><a class="link" href="#_problem_7">2.6.1. Problem</a></h4>
<div class="paragraph">
<p>A task in your workflow produces two or more files at time. A downstream task needs to process each
of these files independently.</p>
</div>
</div>
<div class="sect3">
<h4 id="_solution_7"><a class="link" href="#_solution_7">2.6.2. Solution</a></h4>
<div class="paragraph">
<p>Use the <a href="https://www.nextflow.io/docs/latest/operator.html#flatten">flatten</a> operator to
transform the outputs of the upstream process to a channel emitting each file separately.
Then use this channel as input for the downstream process.</p>
</div>
</div>
<div class="sect3">
<h4 id="_code_7"><a class="link" href="#_code_7">2.6.3. Code</a></h4>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight nowrap"><code data-lang="nextflow"><table class="CodeRay"><tr>
  <td class="line-numbers"><pre>1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
</pre></td>
  <td class="code"><pre>process foo {
  output:
  file '*.txt' into foo_ch
  script:
  '''
  echo Hello there! &gt; file1.txt
  echo What a beautiful day &gt; file2.txt
  echo I wish you are having fun1 &gt; file3.txt
  '''
}

process foo {
  input:
  file x from foo_ch.flatten()
  script:
  &quot;&quot;&quot;
  cat $x
  &quot;&quot;&quot;
}</pre></td>
</tr></table></code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_run_it_8"><a class="link" href="#_run_it_8">2.6.4. Run it</a></h4>
<div class="paragraph">
<p>Use the the following command to execute the example:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code>nextflow run patterns/process-per-file-output.nf</code></pre>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_gather_results"><a class="link" href="#_gather_results">3. Gather results</a></h2>
<div class="sectionbody">
<div class="sect2">
<h3 id="_process_all_outputs_altogether"><a class="link" href="#_process_all_outputs_altogether">3.1. Process all outputs altogether</a></h3>
<div class="sect3">
<h4 id="_problem_8"><a class="link" href="#_problem_8">3.1.1. Problem</a></h4>
<div class="paragraph">
<p>You need to process all the outputs of an upstream task altogether.</p>
</div>
</div>
<div class="sect3">
<h4 id="_solution_8"><a class="link" href="#_solution_8">3.1.2. Solution</a></h4>
<div class="paragraph">
<p>Use the <a href="https://www.nextflow.io/docs/latest/operator.html#collect">collect</a> operator to gather
all the outputs produced by the upstream task and emit them as a sole output.
Then use the resulting channel as input input for the process.</p>
</div>
</div>
<div class="sect3">
<h4 id="_code_8"><a class="link" href="#_code_8">3.1.3. Code</a></h4>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight nowrap"><code data-lang="nextflow"><table class="CodeRay"><tr>
  <td class="line-numbers"><pre>1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
</pre></td>
  <td class="code"><pre>Channel.fromPath('reads/*_1.fq.gz').set { samples_ch }

process foo {
  input:
  file x from samples_ch
  output:
  file 'file.fq' into unzipped_ch
  script:
  &quot;&quot;&quot;
  &lt; $x zcat &gt; file.fq
  &quot;&quot;&quot;
}

process bar {
  echo true
  input:
  file '*.fq' from unzipped_ch.collect()
  &quot;&quot;&quot;
  cat *.fq
  &quot;&quot;&quot;
}</pre></td>
</tr></table></code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_run_it_9"><a class="link" href="#_run_it_9">3.1.4. Run it</a></h4>
<div class="paragraph">
<p>Use the the following command to execute the example:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code>nextflow run patterns/process-collect.nf</code></pre>
</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_process_outputs_into_groups"><a class="link" href="#_process_outputs_into_groups">3.2. Process outputs into groups</a></h3>
<div class="sect3">
<h4 id="_problem_9"><a class="link" href="#_problem_9">3.2.1. Problem</a></h4>
<div class="paragraph">
<p>You need to process in the same batch all files that have a matching key in the file name.</p>
</div>
</div>
<div class="sect3">
<h4 id="_solution_9"><a class="link" href="#_solution_9">3.2.2. Solution</a></h4>
<div class="paragraph">
<p>Use the <a href="https://www.nextflow.io/docs/latest/operator.html#map">map</a> operator to associate with each file
a key extracted from the file name. Then chain the resulting channel with the <a href="https://www.nextflow.io/docs/latest/operator.html#grouptuple">groupTuple</a> operator to group together all files that have a matching key. Finally use the resulting channel as input for the process.</p>
</div>
</div>
<div class="sect3">
<h4 id="_code_9"><a class="link" href="#_code_9">3.2.3. Code</a></h4>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight nowrap"><code data-lang="nextflow"><table class="CodeRay"><tr>
  <td class="line-numbers"><pre>1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
</pre></td>
  <td class="code"><pre>Channel
    .fromPath('reads/*')
    .map { file -&gt;
        def key = file.name.toString().tokenize('_').get(0)
        return tuple(key, file)
     }
    .groupTuple()
    .set{ groups_ch }


process foo {
  input:
  set key, file(samples) from groups_ch

  script:
  &quot;&quot;&quot;
  echo your_command --batch $key --input $samples
  &quot;&quot;&quot;
}</pre></td>
</tr></table></code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_run_it_10"><a class="link" href="#_run_it_10">3.2.4. Run it</a></h4>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code>nextflow run patterns/process-into-groups.nf</code></pre>
</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_collect_outputs_into_a_file"><a class="link" href="#_collect_outputs_into_a_file">3.3. Collect outputs into a file</a></h3>
<div class="sect3">
<h4 id="_problem_10"><a class="link" href="#_problem_10">3.3.1. Problem</a></h4>
<div class="paragraph">
<p>You need to concatenate into a single file all output files produced by an upstream process.</p>
</div>
</div>
<div class="sect3">
<h4 id="_solution_10"><a class="link" href="#_solution_10">3.3.2. Solution</a></h4>
<div class="paragraph">
<p>Use the <a href="https://www.nextflow.io/docs/latest/operator.html#collectfile">collectFile</a> operator to merge all
the output files into a single file.</p>
</div>
</div>
<div class="sect3">
<h4 id="_code_10"><a class="link" href="#_code_10">3.3.3. Code</a></h4>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight nowrap"><code data-lang="nextflow"><table class="CodeRay"><tr>
  <td class="line-numbers"><pre>1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
</pre></td>
  <td class="code"><pre>Channel.fromPath('reads/*_1.fq.gz').set { samples_ch }

process foo {
  input:
  file x from samples_ch
  output:
  file 'file.fq' into unzipped_ch
  script:
  &quot;&quot;&quot;
  &lt; $x zcat &gt; file.fq
  &quot;&quot;&quot;
}

unzipped_ch
      .collectFile()
      .println{ it.text }</pre></td>
</tr></table></code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_run_it_11"><a class="link" href="#_run_it_11">3.3.4. Run it</a></h4>
<div class="paragraph">
<p>Use the the following command to execute the example:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code>nextflow run patterns/collect-into-file.nf</code></pre>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_organize_outputs"><a class="link" href="#_organize_outputs">4. Organize outputs</a></h2>
<div class="sectionbody">
<div class="sect2">
<h3 id="_store_process_outputs"><a class="link" href="#_store_process_outputs">4.1. Store process outputs</a></h3>
<div class="sect3">
<h4 id="_problem_11"><a class="link" href="#_problem_11">4.1.1. Problem</a></h4>
<div class="paragraph">
<p>You need to store the outputs of one or more processes into a directory structure of your choice.</p>
</div>
</div>
<div class="sect3">
<h4 id="_solution_11"><a class="link" href="#_solution_11">4.1.2. Solution</a></h4>
<div class="paragraph">
<p>Use the <a href="https://www.nextflow.io/docs/latest/process.html#publishdir">publishDir</a> directive
to set a custom directory where the process outputs need to be made available.</p>
</div>
</div>
<div class="sect3">
<h4 id="_code_11"><a class="link" href="#_code_11">4.1.3. Code</a></h4>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight nowrap"><code data-lang="nextflow"><table class="CodeRay"><tr>
  <td class="line-numbers"><pre>1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
</pre></td>
  <td class="code"><pre>params.reads = 'reads/*{1,2}.fq.gz'
params.outdir = 'my-results'

Channel.fromFilePairs(params.reads).set{ samples_ch }

process foo {
  publishDir &quot;$params.outdir/$sampleId&quot;
  input:
  set sampleId, file(samples) from samples_ch
  output:
  file '*.fq'

  script:
  &quot;&quot;&quot;
  &lt; ${samples[0]} zcat &gt; sample_1.fq
  &lt; ${samples[1]} zcat &gt; sample_2.fq
  &quot;&quot;&quot;
}</pre></td>
</tr></table></code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_run_it_12"><a class="link" href="#_run_it_12">4.1.4. Run it</a></h4>
<div class="paragraph">
<p>Run the script with the following command:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code>nextflow run patterns/publish-process-outputs.nf</code></pre>
</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_store_outputs_matching_a_glob_pattern"><a class="link" href="#_store_outputs_matching_a_glob_pattern">4.2. Store outputs matching a glob pattern</a></h3>
<div class="sect3">
<h4 id="_problem_12"><a class="link" href="#_problem_12">4.2.1. Problem</a></h4>
<div class="paragraph">
<p>A task in your workflow creates many output files that are required by a downstream task.
You want to store some of those files into separate directories depending the file name.</p>
</div>
</div>
<div class="sect3">
<h4 id="_solution_12"><a class="link" href="#_solution_12">4.2.2. Solution</a></h4>
<div class="paragraph">
<p>Use two or more <a href="https://www.nextflow.io/docs/latest/process.html#publishdir">publishDir</a> directives
to store the output files into separate storing paths. For each directive specify a different glob string
using the option <code>pattern</code> to store into each directory only the files that match the provided pattern.</p>
</div>
</div>
<div class="sect3">
<h4 id="_code_12"><a class="link" href="#_code_12">4.2.3. Code</a></h4>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight nowrap"><code data-lang="nextflow"><table class="CodeRay"><tr>
  <td class="line-numbers"><pre>1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
</pre></td>
  <td class="code"><pre>params.reads = 'reads/*_{1,2}.fq.gz'
params.outdir = 'my-results'

Channel
    .fromFilePairs(params.reads, flat: true)
    .set{ samples_ch }

process foo {
  publishDir &quot;$params.outdir/$sampleId/counts&quot;, pattern: &quot;*_counts.txt&quot;
  publishDir &quot;$params.outdir/$sampleId/outlooks&quot;, pattern: '*_outlook.txt'
  publishDir &quot;$params.outdir/$sampleId/&quot;, pattern: '*.fq'

  input:
    set sampleId, file('sample1.fq.gz'), file('sample2.fq.gz') from samples_ch
  output:
    file &quot;*&quot;
  script:
  &quot;&quot;&quot;
    &lt; sample1.fq.gz zcat &gt; sample1.fq
    &lt; sample2.fq.gz zcat &gt; sample2.fq

    awk '{s++}END{print s/4}' sample1.fq &gt; sample1_counts.txt
    awk '{s++}END{print s/4}' sample2.fq &gt; sample2_counts.txt

    head -n 50 sample1.fq &gt; sample1_outlook.txt
    head -n 50 sample2.fq &gt; sample2_outlook.txt
  &quot;&quot;&quot;
}</pre></td>
</tr></table></code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_run_it_13"><a class="link" href="#_run_it_13">4.2.4. Run it</a></h4>
<div class="paragraph">
<p>Run the script with the following command:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code>nextflow run patterns/publish-matching-glob.nf</code></pre>
</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_rename_process_outputs"><a class="link" href="#_rename_process_outputs">4.3. Rename process outputs</a></h3>
<div class="sect3">
<h4 id="_problem_13"><a class="link" href="#_problem_13">4.3.1. Problem</a></h4>
<div class="paragraph">
<p>You need to store the outputs of a process to a directory
giving files a name of your choice.</p>
</div>
</div>
<div class="sect3">
<h4 id="_solution_13"><a class="link" href="#_solution_13">4.3.2. Solution</a></h4>
<div class="paragraph">
<p>The <a href="https://www.nextflow.io/docs/latest/process.html#publishdir">publishDir</a>
allows you to store the process outputs in a directory of your choice.</p>
</div>
<div class="paragraph">
<p>Specify the <code>saveAs</code> parameter to give each file a name of your choice proving
a custom rule as a <a href="https://www.nextflow.io/docs/latest/script.html#closures">closure</a>.</p>
</div>
</div>
<div class="sect3">
<h4 id="_code_13"><a class="link" href="#_code_13">4.3.3. Code</a></h4>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight nowrap"><code data-lang="nextflow"><table class="CodeRay"><tr>
  <td class="line-numbers"><pre>1
2
3
4
5
6
7
8
9
10
11
</pre></td>
  <td class="code"><pre>process foo {
 publishDir 'results', saveAs: { filename -&gt; &quot;foo_$filename&quot; }

 output:
 file '*.txt'

 '''
 touch this.txt
 touch that.txt
 '''
}</pre></td>
</tr></table></code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_run_it_14"><a class="link" href="#_run_it_14">4.3.4. Run it</a></h4>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code>nextflow run patterns/publish-rename-outputs.nf</code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_save_outputs_in_a_sub_directory"><a class="link" href="#_save_outputs_in_a_sub_directory">4.3.5. Save outputs in a sub-directory</a></h4>
<div class="paragraph">
<p>The same pattern can be used to store specific files in separate directories
depending the actual name.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight nowrap"><code data-lang="nextflow"><table class="CodeRay"><tr>
  <td class="line-numbers"><pre>1
2
3
4
5
6
7
8
9
10
11
</pre></td>
  <td class="code"><pre>process foo {
 publishDir 'results', saveAs: { filename -&gt; filename.endsWith(&quot;.zip&quot;) ? &quot;zips/$filename&quot; : filename }

 output:
 file '*'

 '''
 touch this.txt
 touch that.zip
 '''
}</pre></td>
</tr></table></code></pre>
</div>
</div>
<div class="admonitionblock tip">
<table>
<tr>
<td class="icon">
<i class="fa icon-tip" title="Tip"></i>
</td>
<td class="content">
Relative paths are resolved against the <code>publishDir</code> store path. Use an absolute path
to store files in a directory outside the <code>publishDir</code> store path.
</td>
</tr>
</table>
</div>
</div>
<div class="sect3">
<h4 id="_run_it_15"><a class="link" href="#_run_it_15">4.3.6. Run it</a></h4>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code>nextflow run patterns/publish-rename-outputs-subdirs.nf</code></pre>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_other"><a class="link" href="#_other">5. Other</a></h2>
<div class="sectionbody">
<div class="sect2">
<h3 id="_get_process_work_directory"><a class="link" href="#_get_process_work_directory">5.1. Get process work directory</a></h3>
<div class="sect3">
<h4 id="_problem_14"><a class="link" href="#_problem_14">5.1.1. Problem</a></h4>
<div class="paragraph">
<p>A tool need the explicit path of the current task work directory.</p>
</div>
</div>
<div class="sect3">
<h4 id="_solution_14"><a class="link" href="#_solution_14">5.1.2. Solution</a></h4>
<div class="paragraph">
<p>Use the <code>$PWD</code> Bash variable or the <code>pwd</code> command to retrieve the task working directory path.</p>
</div>
<div class="paragraph">
<p>Note: Make sure use to escape the <code>$</code> variable placeholder
when the command script is enclosed in double quote characters.</p>
</div>
</div>
<div class="sect3">
<h4 id="_example"><a class="link" href="#_example">5.1.3. Example</a></h4>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight nowrap"><code data-lang="nextflow"><table class="CodeRay"><tr>
  <td class="line-numbers"><pre>1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
</pre></td>
  <td class="code"><pre>process foo {
  echo true
  script:
  &quot;&quot;&quot;
  echo foo task path: \$PWD
  &quot;&quot;&quot;
}

process bar {
  echo true
  script:
  '''
  echo bar task path: $PWD
  '''
}</pre></td>
</tr></table></code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_run_it_16"><a class="link" href="#_run_it_16">5.1.4. Run it</a></h4>
<div class="paragraph">
<p>The command run the script with an empty channel:</p>
</div>
<div class="literalblock">
<div class="content">
<pre>nextflow run patterns/process-get-workdir.nf</pre>
</div>
</div>
<div class="paragraph">
<p>Use the following command to provide the same script
some input files, that prevents the process to be executed:</p>
</div>
<div class="literalblock">
<div class="content">
<pre>nextflow run patterns/process-get-workdir.nf --inputs ../data/prots/\*</pre>
</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_ignore_failing_process"><a class="link" href="#_ignore_failing_process">5.2. Ignore failing process</a></h3>
<div class="sect3">
<h4 id="_problem_15"><a class="link" href="#_problem_15">5.2.1. Problem</a></h4>
<div class="paragraph">
<p>A task is expected to fail in a certain condition. You want to ignore the failure and continue the execution of the remaining tasks in the workflow.</p>
</div>
</div>
<div class="sect3">
<h4 id="_solution_15"><a class="link" href="#_solution_15">5.2.2. Solution</a></h4>
<div class="paragraph">
<p>Use the process <a href="https://www.nextflow.io/docs/latest/process.html#errorstrategy">directive</a> <code>errorStrategy 'ignore'</code> to ignore the error condition.</p>
</div>
</div>
<div class="sect3">
<h4 id="_code_14"><a class="link" href="#_code_14">5.2.3. Code</a></h4>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight nowrap"><code data-lang="nextflow"><table class="CodeRay"><tr>
  <td class="line-numbers"><pre>1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
</pre></td>
  <td class="code"><pre>process foo {
  errorStrategy 'ignore'
  script:
  '''
    echo This is going to fail!
    exit 1
  '''
}

process bar {
  script:
  '''
  echo OK
  '''
}</pre></td>
</tr></table></code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_run_it_17"><a class="link" href="#_run_it_17">5.2.4. Run it</a></h4>
<div class="paragraph">
<p>Run the script with the following command:</p>
</div>
<div class="literalblock">
<div class="content">
<pre>nextflow run patterns/ignore-failing-process.nf</pre>
</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_mock_dependency"><a class="link" href="#_mock_dependency">5.3. Mock dependency</a></h3>
<div class="sect3">
<h4 id="_problem_16"><a class="link" href="#_problem_16">5.3.1. Problem</a></h4>
<div class="paragraph">
<p>You need to synchronize the execution of two processes
for which there isn&#8217;t a direct input-output relationship,
so that process <code>bar</code> is executed only after the
completion of process <code>foo</code>.</p>
</div>
</div>
<div class="sect3">
<h4 id="_solution_16"><a class="link" href="#_solution_16">5.3.2. Solution</a></h4>
<div class="paragraph">
<p>Add to the outputs of process <code>foo</code> a channel producing
a <em>flag</em> value.</p>
</div>
<div class="paragraph">
<p>Then use this channel as input for process <code>bar</code> to trigger
its execution when the other process completes.</p>
</div>
</div>
<div class="sect3">
<h4 id="_code_15"><a class="link" href="#_code_15">5.3.3. Code</a></h4>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight nowrap"><code data-lang="nextflow"><table class="CodeRay"><tr>
  <td class="line-numbers"><pre>1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
</pre></td>
  <td class="code"><pre>Channel
    .fromPath('.data/reads/*.fq.gz')
    .set{ reads_ch }

process foo {
    output:
    val true into done_ch

    script:
    &quot;&quot;&quot;
    your_command_here
    &quot;&quot;&quot;
}

process bar {
    input:
    val flag from done_ch
    file fq from reads_ch

    script:
    &quot;&quot;&quot;
    other_commad_here --reads $fq
    &quot;&quot;&quot;
}</pre></td>
</tr></table></code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_run_it_18"><a class="link" href="#_run_it_18">5.3.4. Run it</a></h4>
<div class="paragraph">
<p>Run the example using this command:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code>nextflow run patterns/mock-dependency.nf</code></pre>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_advanced_patterns"><a class="link" href="#_advanced_patterns">6. Advanced patterns</a></h2>
<div class="sectionbody">
<div class="sect2">
<h3 id="_conditional_resources_definition"><a class="link" href="#_conditional_resources_definition">6.1. Conditional resources definition</a></h3>
<div class="sect3">
<h4 id="_problem_17"><a class="link" href="#_problem_17">6.1.1. Problem</a></h4>
<div class="paragraph">
<p>A task in your workflow requires to use an amount of computing
resources eg. memory that depends on the size or the name of one
or more input files.</p>
</div>
</div>
<div class="sect3">
<h4 id="_solution_17"><a class="link" href="#_solution_17">6.1.2. Solution</a></h4>
<div class="paragraph">
<p>Declare the resource requirements e.g. <code>memory</code>, <code>cpus</code>, etc.
in a dynamic manner using a closure.</p>
</div>
<div class="paragraph">
<p>The closure computes the required amount of resources using the file
attributes, such as <code>size</code>, etc., of the inputs declared in the process
definition.</p>
</div>
</div>
<div class="sect3">
<h4 id="_code_16"><a class="link" href="#_code_16">6.1.3. Code</a></h4>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight nowrap"><code data-lang="nextflow"><table class="CodeRay"><tr>
  <td class="line-numbers"><pre>1
2
3
4
5
6
7
8
9
10
11
12
13
14
</pre></td>
  <td class="code"><pre>Channel
    .fromPath('reads/*_1.fq.gz')
    .set { reads_ch }

process foo {
    memory { reads.size() &lt; 70.KB ? 1.GB : 5.GB }

    input:
    file reads from reads_ch

    &quot;&quot;&quot;
    your_command_here --in $reads
    &quot;&quot;&quot;
}</pre></td>
</tr></table></code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_run_it_19"><a class="link" href="#_run_it_19">6.1.4. Run it</a></h4>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code>nextflow run patterns/conditional-resources.nf</code></pre>
</div>
</div>
<div class="paragraph">
<p>Note: requires version 0.32.0 or later.</p>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_conditional_process_executions"><a class="link" href="#_conditional_process_executions">6.2. Conditional process executions</a></h3>
<div class="sect3">
<h4 id="_problem_18"><a class="link" href="#_problem_18">6.2.1. Problem</a></h4>
<div class="paragraph">
<p>Two different tasks need to be executed in a mutually exclusive manner,
then a third task should post-process the results of the previous execution.</p>
</div>
</div>
<div class="sect3">
<h4 id="_solution_18"><a class="link" href="#_solution_18">6.2.2. Solution</a></h4>
<div class="paragraph">
<p>Use a <a href="https://www.nextflow.io/docs/latest/process.html#when">when</a> statement to conditionally
execute two different processes. Each process declares its own output channel.</p>
</div>
<div class="paragraph">
<p>Then use the <a href="https://www.nextflow.io/docs/latest/operator.html#mix">mix</a> operator to create
a new channel that will emit the outputs produced by the two processes and use it as the input
for the third process.</p>
</div>
</div>
<div class="sect3">
<h4 id="_code_17"><a class="link" href="#_code_17">6.2.3. Code</a></h4>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight nowrap"><code data-lang="nextflow"><table class="CodeRay"><tr>
  <td class="line-numbers"><pre>1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
</pre></td>
  <td class="code"><pre>params.flag = false

process foo {
  output:
  file 'x.txt' into foo_ch
  when:
  !params.flag

  script:
  '''
  echo foo &gt; x.txt
  '''
}

process bar {
  output:
  file 'x.txt' into bar_ch
  when:
  params.flag

  script:
  '''
  echo bar &gt; x.txt
  '''
}

process omega {
  echo true
  input:
  file x from foo_ch.mix(bar_ch)

  script:
  &quot;&quot;&quot;
  cat $x
  &quot;&quot;&quot;
}</pre></td>
</tr></table></code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_run_it_20"><a class="link" href="#_run_it_20">6.2.4. Run it</a></h4>
<div class="paragraph">
<p>Use the the following command to execute the example:</p>
</div>
<div class="literalblock">
<div class="content">
<pre>nextflow run patterns/conditional-process.nf</pre>
</div>
</div>
<div class="paragraph">
<p>The processes <code>foo</code> and <code>omega</code> are executed. Run the same command
with the <code>--flag</code> command line option.</p>
</div>
<div class="literalblock">
<div class="content">
<pre>nextflow run patterns/conditional-process.nf --foo</pre>
</div>
</div>
<div class="paragraph">
<p>This time the processes <code>bar</code> and <code>omega</code> are executed.</p>
</div>
</div>
<div class="sect3">
<h4 id="_alternative_solution"><a class="link" href="#_alternative_solution">6.2.5. Alternative solution</a></h4>
<div class="paragraph">
<p>Conditionally create the input channels normally (with data) or as
<a href="https://www.nextflow.io/docs/latest/channel.html#empty">empty</a> channels.
The process consuming the individual input channels will only execute if
the channel is populated. Each process still declares its own output channel.</p>
</div>
<div class="paragraph">
<p>Then use the <a href="https://www.nextflow.io/docs/latest/operator.html#mix">mix</a> operator to create
a new channel that will emit the outputs produced by the two processes and use it as the input
for the third process.</p>
</div>
</div>
<div class="sect3">
<h4 id="_code_18"><a class="link" href="#_code_18">6.2.6. Code</a></h4>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight nowrap"><code data-lang="nextflow"><table class="CodeRay"><tr>
  <td class="line-numbers"><pre>1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
</pre></td>
  <td class="code"><pre>params.flag = false

(foo_inch, bar_inch) = ( params.flag
                     ? [ Channel.empty(), Channel.from(1,2,3) ]
                     : [ Channel.from(4,5,6), Channel.empty() ] )

process foo {

  input:
  val(f) from foo_inch

  output:
  file 'x.txt' into foo_ch

  script:
  &quot;&quot;&quot;
  echo $f &gt; x.txt
  &quot;&quot;&quot;
}

process bar {
  input:
  val(b) from bar_inch

  output:
  file 'x.txt' into bar_ch

  script:
  &quot;&quot;&quot;
  echo $b &gt; x.txt
  &quot;&quot;&quot;
}

process omega {
  echo true
  input:
  file x from foo_ch.mix(bar_ch)

  script:
  &quot;&quot;&quot;
  cat $x
  &quot;&quot;&quot;
}</pre></td>
</tr></table></code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_run_it_21"><a class="link" href="#_run_it_21">6.2.7. Run it</a></h4>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code>nextflow run patterns/conditional-process2.nf</code></pre>
</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_skip_process_execution"><a class="link" href="#_skip_process_execution">6.3. Skip process execution</a></h3>
<div class="sect3">
<h4 id="_problem_19"><a class="link" href="#_problem_19">6.3.1. Problem</a></h4>
<div class="paragraph">
<p>You have two sequential tasks in your workflow. When an optional flag is specified
the first task should not be executed and its input(s) is processed by the second task.</p>
</div>
</div>
<div class="sect3">
<h4 id="_solution_19"><a class="link" href="#_solution_19">6.3.2. Solution</a></h4>
<div class="paragraph">
<p>Use an empty channel, created in a conditional expression, to skip the
first process execution when an optional parameter is specified.</p>
</div>
<div class="paragraph">
<p>Then, define the second process input as a <a href="https://www.nextflow.io/docs/latest/operator.html#mix">mix</a>
of the first process output (when executed) and the input channel.</p>
</div>
</div>
<div class="sect3">
<h4 id="_code_19"><a class="link" href="#_code_19">6.3.3. Code</a></h4>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight nowrap"><code data-lang="nextflow"><table class="CodeRay"><tr>
  <td class="line-numbers"><pre>1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
</pre></td>
  <td class="code"><pre>params.skip = false
params.input = &quot;$baseDir/sample.fq.gz&quot;

Channel.fromPath(params.input).set{ input_ch }

(foo_ch, bar_ch) = ( params.skip
                 ? [Channel.empty(), input_ch]
                 : [input_ch, Channel.empty()] )

process foo {
  input:
  file x from foo_ch

  output:
  file('*.fastq') into optional_ch

  script:
  &quot;&quot;&quot;
  &lt; $x zcat &gt; ${x.simpleName}.fastq
  &quot;&quot;&quot;
}

process bar {
  echo true
  input:
  file x from bar_ch.mix(optional_ch)
  &quot;&quot;&quot;
  echo your_command --input $x
  &quot;&quot;&quot;
}</pre></td>
</tr></table></code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_run_it_22"><a class="link" href="#_run_it_22">6.3.4. Run it</a></h4>
<div class="paragraph">
<p>Use the the following command to execute the example:</p>
</div>
<div class="literalblock">
<div class="content">
<pre>nextflow run patterns/skip-process-execution.nf</pre>
</div>
</div>
<div class="paragraph">
<p>The processes <code>foo</code> and <code>bar</code> are executed. Run the same command
with the <code>--skip</code> command line option.</p>
</div>
<div class="literalblock">
<div class="content">
<pre>nextflow run patterns/skip-process-execution.nf --skip</pre>
</div>
</div>
<div class="paragraph">
<p>This time only processes <code>bar</code> is executed.</p>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_feedback_loop"><a class="link" href="#_feedback_loop">6.4. Feedback loop</a></h3>
<div class="sect3">
<h4 id="_problem_20"><a class="link" href="#_problem_20">6.4.1. Problem</a></h4>
<div class="paragraph">
<p>You need to repeat the execution of one or more tasks, using the output as the input for a new iteration, until a certain condition is reached.</p>
</div>
</div>
<div class="sect3">
<h4 id="_solution_20"><a class="link" href="#_solution_20">6.4.2. Solution</a></h4>
<div class="paragraph">
<p>Use the output of the last process in the iteration loop as the input for the first process.</p>
</div>
<div class="paragraph">
<p>To do so, explicitly create the output channel using <a href="https://www.nextflow.io/docs/latest/channel.html#create">Channel.create</a> method.</p>
</div>
<div class="paragraph">
<p>Then define the process input as a <a href="https://www.nextflow.io/docs/latest/operator.html#mix">mix</a> of the initial input and the
process output to which is applied the <a href="https://www.nextflow.io/docs/latest/operator.html#until">until</a> operator which defines the termination condition.</p>
</div>
</div>
<div class="sect3">
<h4 id="_code_20"><a class="link" href="#_code_20">6.4.3. Code</a></h4>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight nowrap"><code data-lang="nextflow"><table class="CodeRay"><tr>
  <td class="line-numbers"><pre>1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
</pre></td>
  <td class="code"><pre>params.input = 'hello.txt'

condition = { it.readLines().size()&gt;3 }
feedback_ch = Channel.create()
input_ch = Channel.fromPath(params.input).mix( feedback_ch.until(condition) )

process foo {
    input:
    file x from input_ch
    output:
    file 'foo.txt' into foo_ch
    script:
    &quot;&quot;&quot;
    cat $x &gt; foo.txt
    &quot;&quot;&quot;
}

process bar {
    input:
    file x from foo_ch
    output:
    file 'bar.txt' into feedback_ch
    file 'bar.txt' into result_ch
    script:
    &quot;&quot;&quot;
    cat $x &gt; bar.txt
    echo World &gt;&gt; bar.txt
    &quot;&quot;&quot;
}

result_ch.last().println { &quot;Result:\n${it.text.indent(' ')}&quot; }</pre></td>
</tr></table></code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_run_it_23"><a class="link" href="#_run_it_23">6.4.4. Run it</a></h4>
<div class="paragraph">
<p>Use the the following command to execute the example:</p>
</div>
<div class="literalblock">
<div class="content">
<pre>nextflow run patterns/feedback-loop.nf</pre>
</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_optional_input"><a class="link" href="#_optional_input">6.5. Optional input</a></h3>
<div class="sect3">
<h4 id="_problem_21"><a class="link" href="#_problem_21">6.5.1. Problem</a></h4>
<div class="paragraph">
<p>One or more processes have an optional input file.</p>
</div>
</div>
<div class="sect3">
<h4 id="_solution_21"><a class="link" href="#_solution_21">6.5.2. Solution</a></h4>
<div class="paragraph">
<p>Use a special file name to mark the absence of the file parameter.</p>
</div>
</div>
<div class="sect3">
<h4 id="_code_21"><a class="link" href="#_code_21">6.5.3. Code</a></h4>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight nowrap"><code data-lang="nextflow"><table class="CodeRay"><tr>
  <td class="line-numbers"><pre>1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
</pre></td>
  <td class="code"><pre>params.inputs = 'prots/*{1,2,3}.fa'
params.filter = 'NO_FILE'

prots_ch = Channel.fromPath(params.inputs)
opt_file = file(params.filter)

process foo {
  input:
  file seq from prots_ch
  file opt from opt_file

  script:
  def filter = opt.name != 'NO_FILE' ? &quot;--filter $opt&quot; : ''
  &quot;&quot;&quot;
  your_commad --input $seq $filter
  &quot;&quot;&quot;
}</pre></td>
</tr></table></code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_run_it_24"><a class="link" href="#_run_it_24">6.5.4. Run it</a></h4>
<div class="paragraph">
<p>Run the script with the following command:</p>
</div>
<div class="literalblock">
<div class="content">
<pre>nextflow run patterns/optional-input.nf</pre>
</div>
</div>
<div class="paragraph">
<p>Run the same script providing an optional file input:</p>
</div>
<div class="literalblock">
<div class="content">
<pre>nextflow run patterns/optional-input.nf --filter foo.txt</pre>
</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_optional_output"><a class="link" href="#_optional_output">6.6. Optional output</a></h3>
<div class="sect3">
<h4 id="_problem_22"><a class="link" href="#_problem_22">6.6.1. Problem</a></h4>
<div class="paragraph">
<p>A task in your workflow is expected to not create an output file in some circumstances.</p>
</div>
</div>
<div class="sect3">
<h4 id="_solution_22"><a class="link" href="#_solution_22">6.6.2. Solution</a></h4>
<div class="paragraph">
<p>Declare such output as an <code>optional</code> file.</p>
</div>
</div>
<div class="sect3">
<h4 id="_code_22"><a class="link" href="#_code_22">6.6.3. Code</a></h4>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight nowrap"><code data-lang="nextflow"><table class="CodeRay"><tr>
  <td class="line-numbers"><pre>1
2
3
4
5
6
7
8
9
</pre></td>
  <td class="code"><pre>process foo {
  output:
  file 'foo.txt' optional true into foo_ch

  script:
  '''
  your_command
  '''
}</pre></td>
</tr></table></code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_run_it_25"><a class="link" href="#_run_it_25">6.6.4. Run it</a></h4>
<div class="paragraph">
<p>Use the the following command to execute the example:</p>
</div>
<div class="literalblock">
<div class="content">
<pre>nextflow run patterns/optional-output.nf</pre>
</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_execute_when_empty"><a class="link" href="#_execute_when_empty">6.7. Execute when empty</a></h3>
<div class="sect3">
<h4 id="_problem_23"><a class="link" href="#_problem_23">6.7.1. Problem</a></h4>
<div class="paragraph">
<p>You need to execute a process if a channel is empty.</p>
</div>
</div>
<div class="sect3">
<h4 id="_solution_23"><a class="link" href="#_solution_23">6.7.2. Solution</a></h4>
<div class="paragraph">
<p>Use the <a href="https://www.nextflow.io/docs/latest/operator.html#ifempty">ifEmpty</a> operator to emit
a <em>marker</em> value to trigger the execution of the process.</p>
</div>
</div>
<div class="sect3">
<h4 id="_example_2"><a class="link" href="#_example_2">6.7.3. Example</a></h4>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight nowrap"><code data-lang="nextflow"><table class="CodeRay"><tr>
  <td class="line-numbers"><pre>1
2
3
4
5
6
7
8
9
10
11
</pre></td>
  <td class="code"><pre>process foo {
  input:
  val x from ch.ifEmpty { 'EMPTY' }
  when:
  x == 'EMPTY'

  script:
  '''
  your_command
  '''
}</pre></td>
</tr></table></code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_run_it_26"><a class="link" href="#_run_it_26">6.7.4. Run it</a></h4>
<div class="paragraph">
<p>The command run the script with an empty channel:</p>
</div>
<div class="literalblock">
<div class="content">
<pre>nextflow run patterns/process-when-empty.nf</pre>
</div>
</div>
<div class="paragraph">
<p>Use the following command to provide the same script
some input files, that prevents the process to be executed:</p>
</div>
<div class="literalblock">
<div class="content">
<pre>nextflow run patterns/process-when-empty.nf --inputs ../data/prots/\*</pre>
</div>
</div>
</div>
</div>
</div>
</div>
</div>
<script>
    if( window.location.hostname == 'localhost' || window.location.hostname == '127.0.0.1' ) { throw new Error('Skip GA on localhost') };
    (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
    (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
    m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
    })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

    ga('create', 'UA-364526-10', 'auto');
    ga('send', 'pageview');
</script>
</body>
</html>